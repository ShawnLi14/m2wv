<html>
    <head>
        {% include 'header.html' %}
        <!-- css -->
    </head>

    <body>
        <!-- navbar -->
        {% include 'navbar.html' %}

        <!-- main content-->
        <div id="carouselControls" class="carousel slide" data-ride="carousel">
          <div class="carousel-inner">
            <div class="carousel-item active">
              <img src="/static/dolly_sods.jpg" class="d-block w-100" alt="Dolly Sods">
            </div>
            <div class="carousel-item">
              <img src="/static/mill.jpg" class="d-block w-100" alt="Glade Creek Grist Mill">
            </div>
            <div class="carousel-item">
              <img src="/static/bridge_day.jpg" class="d-block w-100" alt="Bridge Day">
            </div>
            <div class="carousel-item">
              <img src="/static/highway.jpg" class="d-block w-100" alt="Coopers Rock">
            </div>
            <div class="carousel-item">
              <img src="/static/coopers_rock.jpg" class="d-block w-100" alt="Interstate">
            </div>
          </div>
          <a class="carousel-control-prev" href="#carouselControls" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="carousel-control-next" href="#carouselControls" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>
        </div>
        <br><br>
        <div class="container">
            <div class="col">
                <blockquote>
                    Are you working remote and tired of all the noise of a big city? Paying an arm and a leg for rent and taxes? Want to live with more wildlife? Move to almost heaven, West Virginia. The greatly decreased tax rates and housing prices give you more options when renting or buying a home. Various outdoor activities in our great mountains provide plenty of opportinuties
                    for recreation. Additionally, the low chance of natural disasters such as tornadoes and earthquakes creates a safe environment to live out your life.
                </blockquote>
            </div>
            <div class="col">
                <h1 class="mainpage">Looking for the best city in West Virginia to relocate to?</h1><br><br>
                <form class="needs-validation" id="submitCensusQuery" action="{{ url_for('results') }}" method="POST">
                <input type="hidden" value="none" name="city" id="city"/>
                <div class="row">
                    <div class="col">
                        <h4 class="mainpage">Select your current place of residence</h4>
                        <select id="states" name="states" required>
                            <option value="">Select State....</option>
                            {% for state in states %}
                            <option value={{ state[1] }}>{{ state[0] }}</option>
                            {% endfor %}
                        </select>
                        <input type="hidden" value="" name="stateName" id="stateName"/>
                        <select id="places" name="places" disabled="true" required>
                        </select>
                        <input type="hidden" value="" name="placeName" id="placeName"/>
                    </div>
                </div>
                <br><br>
                <div class="row">
                    <div class="col">
                        <h4 class="mainpage">Select what's important in a city to you</h4>
                      <div class="form-check form-check-inline"><input class="form-check-input" id="schools" type="checkbox" name="prefs" value="schools"><label class="form-check-label" for="schools">Schools</label> </div>
                      <div class="form-check form-check-inline"><input class="form-check-input" id="safety" type="checkbox" name="prefs" value="safety"><label class="form-check-label" for="safety">Safety</label> </div>
                      <div class="form-check form-check-inline"><input class="form-check-input" id="outdoor_activities" type="checkbox" name="prefs" value="outdoors"><label class="form-check-label" for="outdoor_activies">Outdoors</label> </div>
                      <div class="form-check form-check-inline"><input class="form-check-input" id="cultural" type="checkbox" name="prefs" value="cultural"><label class="form-check-label" for="cultural">Cultural</label> </div>
                      <div class="form-check form-check-inline"><input class="form-check-input" id="rural" type="checkbox" name="prefs" value="rural"><label class="form-check-label" for="rural">Rural</label> </div>
                      <div class="form-check form-check-inline"><input class="form-check-input" id="urban" type="checkbox" name="prefs" value="urban"><label class="form-check-label" for="urban">Urban</label> </div>
                  </div>
                </div>
                <div class="text-center">
                    <br />
                    <input class="btn btn-primary btn-large" type="submit" value="Search!"/>
                    <br /><br />
                </div>
                </form>
            </div>
        </div>
        {% include 'footer.html' %}
        <!-- jQuery -->
        <script>
            $(document).ready(function(){

                //change places dropdown upon state dropdown change
                $("select#states").change(function() {

                    if ($(this).val() != '') {
                        $('select#places').prop('disabled',false);

                        var stateName = $(this).find('option:selected').text();
                        $('#stateName').val(stateName);
                        $.ajax({
                            type: 'GET',
                            url: "/getPlaces",
                            data: { state : stateName },
                            contentType: 'application/json',
                            dataType: 'json',
                            success: function(response) {
                                var options = ["<option value=''>Select City....</option>"];
                                for (var i=0, l=response.length; i<l; i+=2)
                                    options.push('<option value="'+response[i+1]+'">'+response[i]+'</option>');
                                $('select#places').html(options.join(''));
                            }
                        });
                    }
                    else {
                        $('select#places').html('').prop('disabled',true);
                    }
                });

                //update population when place is changed
                $("select#places").change(function() {

                    if ($(this).val() != '') {

                        var placeID = $(this).find('option:selected').val();
                        var stateID = $('select#states').find('option:selected').val();
                        $('#placeName').val($(this).find('option:selected').text());
                        $.ajax({
                            type: 'GET',
                            url: "/getCensusData",
                            data: { placeid : placeID, stateid : stateID},
                            contentType: 'application/json',
                            dataType: 'json',
                            success: function(response) {

                                $('#population').html(response);
                            }
                        });
                    }
                    else {
                        $('#population').text("");
                    }
                });
                /*$("select#places").change(function() {

                    if ($(this).val() != '') {

                        var placeID = $(this).find('option:selected').val();
                        var stateID = $('select#states').find('option:selected').val();
                        $.ajax({
                            type: 'GET',
                            url: "/getPopulation",
                            data: { placeid : placeID, stateid : stateID},
                            contentType: 'application/json',
                            dataType: 'json',
                            success: function(response) {

                                $('#population').html("population: " + response);
                            }
                        });
                    }
                    else {
                        $('#population').text("");
                    }
                });*/
            });
        </script>
    </body>
</html>